<!DOCTYPE html>
<html>
<head>
    <title>Official Content Page</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="/socket.io/socket.io.js"></script>
</head>
<body class="victim-body">
    <div id="main-content">
        <h1>Welcome to our official portal</h1>
        <p>Browsing content... please wait.</p>
    </div>

    <!-- This only appears when admin controls mouse -->
    <div id="victim-desktop" style="display:none;">
        <img id="v-file" src="images/file.png" style="width:64px; position:absolute; top:20%; left:10%;">
    </div>

    <div id="alert-overlay">
        <h1 id="alert-msg"></h1>
    </div>

    <img id="fake-cursor" src="https://cur.cursors-4u.net/arrow/arrow-1.png">

    <script>
        const socket = io();
        socket.emit('join', 'viewer');

        const overlay = document.getElementById('alert-overlay');
        const desktop = document.getElementById('victim-desktop');
        const cursor = document.getElementById('fake-cursor');

        socket.on('exec-prank', (data) => {
            if (data.type === 'custom' || data.type === 'red' || data.type === 'windows') {
                overlay.style.display = 'block';
                if(data.type === 'red') {
                    overlay.className = 'red-screen';
                    document.getElementById('alert-msg').innerText = "CRITICAL MALWARE DETECTED!";
                } else if (data.type === 'windows') {
                    overlay.className = 'blue-screen';
                    document.getElementById('alert-msg').innerHTML = "Updating Windows...<br>99% Complete<br>Keep your PC plugged in.";
                } else {
                    overlay.className = 'blue-screen';
                    document.getElementById('alert-msg').innerText = data.msg;
                }
            } else if (data.type === 'clear') {
                overlay.style.display = 'none';
            } else if (data.type === 'set-mouse-state') {
                desktop.style.display = data.active ? 'block' : 'none';
                cursor.style.display = data.active ? 'block' : 'none';
            } else if (data.type === 'delete-files') {
                document.getElementById('v-file').style.display = 'none';
            }
        });

        socket.on('mouse-sync', (coords) => {
            cursor.style.left = coords.x + 'px';
            cursor.style.top = coords.y + 'px';
        });
    </script>
</body>
</html>